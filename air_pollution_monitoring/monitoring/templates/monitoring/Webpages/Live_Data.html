{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EcoAI - Analytics Dashboard</title>
    <link rel="stylesheet" href="{% static 'Styling/Live_Data.css' %}">
</head>
<body>
    <nav class="nav-container">
        <h2 style="color: var(--primary-green); font-weight: bold;">EcoAI</h2>
        <div class="nav-links">
            <a href="{% url 'home' %}">Home</a>
            <a href="#solutions">Solutions</a>
            <a href="{% url 'live_data' %}">Live Data</a>
            <a href="#contact">Contact</a>
        </div>
    </nav>

    
    <h1>Air Quality Analytics Dashboard</h1>
    <div class="dashboard-container">
        <div class="sensor-grid">
            <div class="sensor-card">
                <h3>PM2.5</h3>
                <p id="pm25">Loading...</p>
            </div>
            <div class="sensor-card">
                <h3>NO₂</h3>
                <p id="no2">Loading...</p>
            </div>
            <div class="sensor-card">
                <h3>O₃</h3>
                <p id="o3">Loading...</p>
            </div>
        </div>
        <div class="chart-container">
            <canvas id="airChart"></canvas>
        </div>
    </div>

    <h2 class="heading">Previous Day AQI's</h2>
    <table class="aqi-table">
        <thead>
            <tr>
                <th>AQI</th>
                <th>State</th>
                <th>Time</th>
                <th>Date</th>
            </tr>
        </thead>
        <tbody id="aqi-table-body">
            <tr><td class="aqi-unhealthy">180</td><td>Delhi</td><td>10:30 AM</td><td>17-Mar-2025</td></tr>
            <tr><td class="aqi-moderate">90</td><td>Mumbai</td><td>10:30 AM</td><td>17-Mar-2025</td></tr>
            <tr><td class="aqi-good">45</td><td>Bangalore</td><td>10:30 AM</td><td>17-Mar-2025</td></tr>
            <tr><td class="aqi-unhealthy">160</td><td>Kolkata</td><td>10:30 AM</td><td>17-Mar-2025</td></tr>
            <tr><td class="aqi-moderate">85</td><td>Chennai</td><td>10:30 AM</td><td>17-Mar-2025</td></tr>
            <tr><td class="aqi-good">50</td><td>Hyderabad</td><td>10:30 AM</td><td>17-Mar-2025</td></tr>
        </tbody>
    </table>


    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        function updateSensorData() {
            document.getElementById('pm25').textContent = Math.floor(Math.random() * 150) + ' µg/m³';
            document.getElementById('no2').textContent = (Math.random() * 0.5).toFixed(2) + ' ppm';
            document.getElementById('o3').textContent = (Math.random() * 0.3).toFixed(2) + ' ppm';
        }

        const ctx = document.getElementById('airChart').getContext('2d');
        const airChart = new Chart(ctx, {
            type: 'line',
            data: {
                labels: [],
                datasets: [{
                    label: 'Air Quality Index',
                    data: [],
                    borderColor: '#2ECC71',
                    backgroundColor: 'rgba(46, 204, 113, 0.2)',
                    fill: true,
                    tension: 0.4
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                animation: {
                    duration: 500,
                    easing: 'easeInOutQuart'
                }
            }
        });

        function updateChart() {
            const maxDataPoints = 20;
            const newLabel = new Date().toLocaleTimeString();
            const newData = Math.floor(Math.random() * 150);
            
            airChart.data.labels.push(newLabel);
            airChart.data.datasets[0].data.push(newData);
            
            if (airChart.data.labels.length > maxDataPoints) {
                airChart.data.labels.shift();
                airChart.data.datasets[0].data.shift();
            }
            
            airChart.update();
        }
        setInterval(updateSensorData, 1000);
        setInterval(updateChart, 1000);
        updateSensorData();
    </script>
</body>
</html>
